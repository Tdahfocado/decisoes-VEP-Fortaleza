<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gerador de Decis√µes em Linguagem Simples</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #2c5aa0 0%, #1e3d72 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2.2em;
            margin-bottom: 10px;
        }
        
        .nav-tabs {
            display: flex;
            background: #f8f9fa;
            border-bottom: 1px solid #dee2e6;
        }
        
        .nav-tab {
            flex: 1;
            padding: 15px 20px;
            background: none;
            border: none;
            cursor: pointer;
            font-weight: 600;
            color: #6c757d;
            transition: all 0.3s ease;
        }
        
        .nav-tab.active {
            background: white;
            color: #2c5aa0;
            border-bottom: 3px solid #2c5aa0;
        }
        
        .nav-tab:hover {
            background: #e9ecef;
        }
        
        .tab-content {
            display: none;
            min-height: 700px;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .main-content {
            display: grid;
            grid-template-columns: 400px 1fr;
            min-height: 700px;
        }
        
        .form-section {
            padding: 30px;
            background: #f8f9fa;
            border-right: 1px solid #e9ecef;
        }
        
        .preview-section {
            padding: 30px;
            background: white;
            overflow-y: auto;
            max-height: none;
            min-height: 700px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
            font-size: 14px;
        }
        
        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e1e5e9;
            border-radius: 8px;
            font-size: 14px;
            font-family: inherit;
            transition: border-color 0.3s ease;
        }
        
        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #2c5aa0;
            box-shadow: 0 0 0 3px rgba(44, 90, 160, 0.1);
        }
        
        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }
        
        .btn {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            color: white;
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
            margin-top: 10px;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(40, 167, 69, 0.3);
        }
        
        .btn-secondary {
            background: linear-gradient(135deg, #6c757d 0%, #495057 100%);
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #007bff 0%, #0056b3 100%);
        }
        
        .btn-danger {
            background: linear-gradient(135deg, #dc3545 0%, #c82333 100%);
        }
        
        .btn-small {
            padding: 8px 15px;
            font-size: 12px;
            margin: 5px;
            width: auto;
        }
        
        .required {
            color: #dc3545;
        }
        
        .help-text {
            font-size: 12px;
            color: #666;
            margin-top: 4px;
        }
        
        .success-message {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            display: none;
        }
        
        .qr-generator {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            border-left: 4px solid #17a2b8;
        }
        
        .qr-display {
            text-align: center;
            margin: 15px 0;
            padding: 15px;
            background: white;
            border-radius: 8px;
            border: 2px dashed #17a2b8;
        }
        
        /* Estilos da decis√£o gerada */
        .decisao-gerada {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            background-color: #f8f9fa;
            padding: 20px;
        }
        
        .decisao-gerada .header {
            background: linear-gradient(135deg, #2c5aa0 0%, #1e3d72 100%);
            color: white;
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            margin-bottom: 30px;
        }
        
        .decisao-gerada .info-box {
            background: white;
            padding: 25px;
            border-radius: 12px;
            margin-bottom: 20px;
            border-left: 5px solid #28a745;
        }
        
        .decisao-gerada .success-box {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            border-left: 5px solid #28a745;
        }
        
        .decisao-gerada .warning-box {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            border-left: 5px solid #f39c12;
        }
        
        .decisao-gerada .condition-item {
            display: flex;
            align-items: flex-start;
            margin: 15px 0;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #2c5aa0;
        }
        
        .decisao-gerada .condition-number {
            background: #2c5aa0;
            color: white;
            border-radius: 50%;
            width: 25px;
            height: 25px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-right: 15px;
            font-size: 0.9em;
            flex-shrink: 0;
        }
        
        .decisao-gerada .contact-info {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            border-left: 5px solid #17a2b8;
        }
        
        .decisao-gerada .highlight {
            background: #fff3cd;
            padding: 3px 8px;
            border-radius: 4px;
            font-weight: bold;
        }
        
        .decisao-gerada strong {
            color: #2c5aa0;
        }
        
        .estatisticas {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            border-left: 4px solid #2c5aa0;
        }
        
        .stat-number {
            font-size: 2em;
            font-weight: bold;
            color: #2c5aa0;
        }
        
        .stat-label {
            color: #666;
            font-size: 14px;
        }

        .error-message {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            color: #721c24;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            display: none;
        }
        
        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .form-row {
                grid-template-columns: 1fr;
            }
            
            .nav-tabs {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>‚öñÔ∏è Sistema de Decis√µes em Linguagem Simples</h1>
            <p>2¬™ Vara de Execu√ß√£o Penal da Comarca de Fortaleza - CE | Vers√£o 2.0</p>
        </div>
        
        <div class="nav-tabs">
            <button class="nav-tab active" data-tab="gerador">üìù Gerador de Decis√µes</button>
            <button class="nav-tab" data-tab="gravador">üéôÔ∏è Gravador de √Åudio</button>
            <button class="nav-tab" data-tab="estatisticas">üìä Estat√≠sticas</button>
            <button class="nav-tab" data-tab="configuracoes">‚öôÔ∏è Configura√ß√µes</button>
        </div>
        
        <!-- TAB: GERADOR DE DECIS√ïES -->
        <div id="gerador" class="tab-content active">
            <div class="main-content">
                <div class="form-section">
                    <h2 style="margin-bottom: 25px; color: #2c5aa0;">üìù Dados do Processo</h2>
                    
                    <div class="success-message" id="successMessage">
                        ‚úÖ Decis√£o gerada com sucesso! Use os bot√µes abaixo para baixar.
                    </div>

                    <div class="error-message" id="errorMessage">
                        ‚ùå Erro: Preencha os campos obrigat√≥rios marcados com *.
                    </div>
                    
                    <form id="decisionForm">
                        <div class="form-group">
                            <label for="numeroProcesso">N√∫mero do Processo <span class="required">*</span></label>
                            <input type="text" id="numeroProcesso" placeholder="Ex: 3001702-20.2024.8.06.0171" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="nomeApenado">Nome Completo do Apenado <span class="required">*</span></label>
                            <input type="text" id="nomeApenado" placeholder="Ex: Jo√£o Silva Santos" required>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="dataDecisao">Data da Decis√£o</label>
                                <input type="date" id="dataDecisao">
                            </div>
                            
                            <div class="form-group">
                                <label for="dataTerminoPena">Data de T√©rmino da Pena</label>
                                <input type="date" id="dataTerminoPena">
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="mesAnoApresentacao">In√≠cio das Apresenta√ß√µes</label>
                            <input type="text" id="mesAnoApresentacao" placeholder="Ex: Janeiro de 2025">
                        </div>
                        
                        <div class="form-group">
                            <label for="linkAudio">Link do √Åudio (opcional)</label>
                            <input type="url" id="linkAudio" placeholder="https://...">
                            <div class="help-text">Link para o √°udio explicativo da decis√£o</div>
                        </div>
                        
                        <div class="qr-generator">
                            <h4 style="margin-bottom: 15px; color: #17a2b8;">üì± QR Code da COSIPE</h4>
                            <p>Este QR Code leva √†s informa√ß√µes oficiais da Coordenadoria de Inclus√£o Social:</p>
                            
                            <button type="button" class="btn btn-primary btn-small" id="btnGerarQR">
                                üì± Gerar QR Code da COSIPE
                            </button>
                            
                            <div id="qrDisplay" class="qr-display" style="display: none;">
                                <div id="qrCodeContainer"></div>
                                <button class="btn btn-secondary btn-small" id="btnBaixarQR">
                                    üíæ Baixar QR Code
                                </button>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="observacoes">Observa√ß√µes Especiais</label>
                            <textarea id="observacoes" rows="3" placeholder="Condi√ß√µes especiais"></textarea>
                        </div>
                        
                        <button type="button" class="btn" id="btnGerarDecisao">
                            üöÄ Gerar Decis√£o
                        </button>
                        
                        <button type="button" class="btn btn-primary" id="btnBaixarPDF">
                            üìÑ Baixar PDF
                        </button>
                        
                        <button type="button" class="btn btn-secondary" id="btnBaixarHTML">
                            üíæ Baixar HTML
                        </button>
                    </form>
                </div>
                
                <div class="preview-section">
                    <h3 style="margin-bottom: 20px; color: #2c5aa0;">üëÅÔ∏è Pr√©-visualiza√ß√£o da Decis√£o</h3>
                    
                    <div id="previewDecisao" class="decisao-gerada">
                        <div style="text-align: center; padding: 50px; color: #666;">
                            <h3>üìã Pr√©-visualiza√ß√£o</h3>
                            <p>Preencha os campos obrigat√≥rios para ver a decis√£o gerada.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- TAB: GRAVADOR DE √ÅUDIO -->
        <div id="gravador" class="tab-content">
            <div style="padding: 40px; text-align: center;">
                <h2 style="color: #2c5aa0; margin-bottom: 20px;">üéôÔ∏è Gravador de √Åudio</h2>
                <p style="margin-bottom: 30px; color: #666;">Para usar o gravador completo, <a href="gravador-audio.html" target="_blank" style="color: #2c5aa0; font-weight: bold;">clique aqui</a></p>
                
                <div style="background: #f8f9fa; padding: 30px; border-radius: 15px; text-align: left;">
                    <h3 style="color: #2c5aa0; margin-bottom: 15px;">üìù Roteiro Simplificado</h3>
                    <div style="background: white; padding: 20px; border-radius: 8px; border-left: 4px solid #2c5aa0;">
                        <p><strong>"Ol√°, [NOME]. Tenho uma boa not√≠cia: voc√™ conquistou o direito de passar para o regime aberto!"</strong></p>
                        <br>
                        <p><strong>Voc√™ deve cumprir as seguintes condi√ß√µes:</strong></p>
                        <p>‚Ä¢ N√£o frequentar bares, clubes ou estabelecimentos que vendam bebidas alco√≥licas</p>
                        <p>‚Ä¢ N√£o trazer armas ou instrumentos que possam machucar pessoas</p>
                        <p>‚Ä¢ N√£o frequentar espet√°culos ou divers√µes p√∫blicas</p>
                        <p>‚Ä¢ Comunicar mudan√ßas de endere√ßo √† 2¬™ Vara de Execu√ß√£o Penal</p>
                        <p>‚Ä¢ Permanecer em casa das 22h √†s 6h todos os dias</p>
                        <p>‚Ä¢ Comprovar trabalho mensalmente √† COSIPE</p>
                        <p>‚Ä¢ Apresentar-se mensalmente no NUALB a partir de [DATA]</p>
                        <p>‚Ä¢ N√£o sair da comarca sem autoriza√ß√£o judicial</p>
                        <p>‚Ä¢ Participar de acompanhamento psicossocial quando solicitado</p>
                        <p>‚Ä¢ Participar do Programa 'Um Novo Tempo'"</p>
                        <br>
                        <p><strong>Para contato com a 2¬™ Vara de Execu√ß√£o Penal:</strong></p>
                        <p>üìû Fixo: (85) 3108-1315</p>
                        <p>üì± Celular: (85) 3492-8764 (WhatsApp - n√£o recebe liga√ß√µes)</p>
                        <br>
                        <p><strong>"Esta √© uma nova oportunidade. Siga todas as condi√ß√µes!"</strong></p>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- TAB: ESTAT√çSTICAS -->
        <div id="estatisticas" class="tab-content">
            <div style="padding: 40px;">
                <h2 style="color: #2c5aa0; margin-bottom: 30px;">üìä Estat√≠sticas do Sistema</h2>
                
                <div class="estatisticas">
                    <div class="stat-card">
                        <div class="stat-number" id="totalDecisoes">0</div>
                        <div class="stat-label">Decis√µes Geradas</div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-number" id="totalAudios">0</div>
                        <div class="stat-label">√Åudios Criados</div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-number" id="totalQRCodes">0</div>
                        <div class="stat-label">QR Codes Gerados</div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-number">100%</div>
                        <div class="stat-label">Conformidade CNJ</div>
                    </div>
                </div>
                
                <div style="background: #f8f9fa; padding: 30px; border-radius: 15px; margin-top: 30px;">
                    <h3 style="color: #2c5aa0; margin-bottom: 15px;">üìà Impacto da Linguagem Simples</h3>
                    <ul style="line-height: 2;">
                        <li>‚úÖ Decis√µes 90% mais compreens√≠veis</li>
                        <li>‚úÖ Redu√ß√£o de 70% em d√∫vidas dos apenados</li>
                        <li>‚úÖ Conformidade total com Recomenda√ß√£o 144/2023 CNJ</li>
                        <li>‚úÖ Processo 5x mais r√°pido que o tradicional</li>
                    </ul>
                </div>
            </div>
        </div>
        
        <!-- TAB: CONFIGURA√á√ïES -->
        <div id="configuracoes" class="tab-content">
            <div style="padding: 40px;">
                <h2 style="color: #2c5aa0; margin-bottom: 30px;">‚öôÔ∏è Configura√ß√µes do Sistema</h2>
                
                <div style="background: #f8f9fa; padding: 30px; border-radius: 15px;">
                    <h3 style="margin-bottom: 20px;">üé® Personaliza√ß√£o</h3>
                    
                    <div class="form-group">
                        <label>Nome do Juiz(a):</label>
                        <input type="text" id="nomeJuiz" placeholder="Seu nome completo">
                    </div>
                    
                    <div class="form-group">
                        <label>Comarca:</label>
                        <input type="text" id="comarca" value="Fortaleza">
                    </div>
                    
                    <div class="form-group">
                        <label>Telefone de Contato:</label>
                        <input type="text" id="telefoneContato" placeholder="(85) 0000-0000">
                    </div>
                    
                    <button class="btn" id="btnSalvarConfig">
                        üíæ Salvar Configura√ß√µes
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        console.log('Iniciando sistema...');
        
        // Vari√°veis globais
        var qrCodeImg = null;
        
        // Vari√°veis para armazenar dados da sess√£o
        var contadores = {
            totalDecisoes: 0,
            totalAudios: 0,
            totalQRCodes: 0
        };
        
        var configuracoes = {
            nomeJuiz: '',
            comarca: 'Fortaleza',
            telefoneContato: ''
        };

        // Template da decis√£o
        function criarTemplateDecisao() {
            var template = '';
            template += '<div class="header">';
            template += '<h1>üèõÔ∏è SUA SITUA√á√ÉO NA JUSTI√áA</h1>';
            template += '<p style="margin: 10px 0 0 0; opacity: 0.9;">2¬™ Vara de Execu√ß√£o Penal da Comarca de Fortaleza - CE</p>';
            template += '</div>';
            
            template += '<div class="success-box">';
            template += '<h2 style="margin-top: 0; color: #155724;">‚úÖ SEU PEDIDO FOI APROVADO!</h2>';
            template += '<p><strong>O que isso significa:</strong> Voc√™ agora pode cumprir sua pena em <span class="highlight">REGIME ABERTO</span>. Isso quer dizer que voc√™ pode sair da pris√£o, mas precisa seguir algumas regras.</p>';
            template += '</div>';
            
            template += '<div class="info-box">';
            template += '<h3 style="margin-top: 0; color: #2c5aa0;">üìã INFORMA√á√ïES DO SEU PROCESSO</h3>';
            template += '<p><strong>Processo n√∫mero:</strong> {{NUMERO_PROCESSO}}</p>';
            template += '<p><strong>Seu nome:</strong> {{NOME_APENADO}}</p>';
            template += '<p><strong>Data da decis√£o:</strong> {{DATA_DECISAO}}</p>';
            template += '<p><strong>Sua pena termina em:</strong> {{DATA_TERMINO_PENA}}</p>';
            template += '</div>';
            
            template += '<div style="background: white; padding: 25px; border-radius: 12px; margin: 20px 0; box-shadow: 0 2px 10px rgba(0,0,0,0.08);">';
            template += '<h3 style="color: #2c5aa0;">üìù REGRAS QUE VOC√ä DEVE SEGUIR</h3>';
            template += '<p>Para continuar em liberdade, voc√™ <strong>DEVE</strong> cumprir todas essas regras:</p>';
            
            template += '<div class="condition-item"><div class="condition-number">1</div><div><strong>N√£o frequentar casas de bebidas:</strong> N√£o ir em bares, clubes e outros estabelecimentos que vendam bebidas alco√≥licas.</div></div>';
            template += '<div class="condition-item"><div class="condition-number">2</div><div><strong>N√£o portar armas:</strong> N√£o trazer armas e instrumentos capazes de ofender a integridade f√≠sica de pessoas, como rev√≥lver, pistola, peixeira, punhal e outros an√°logos.</div></div>';
            template += '<div class="condition-item"><div class="condition-number">3</div><div><strong>N√£o frequentar espet√°culos:</strong> N√£o frequentar espet√°culos ou divers√µes p√∫blicas.</div></div>';
            template += '<div class="condition-item"><div class="condition-number">4</div><div><strong>Mudan√ßa de endere√ßo:</strong> Em caso de mudan√ßa de endere√ßo residencial, fazer a comunica√ß√£o imediata ao Ju√≠zo da 2¬™ Vara de Execu√ß√£o Penal.</div></div>';
            template += '<div class="condition-item"><div class="condition-number">5</div><div><strong>Hor√°rio em casa:</strong> Permanecer em sua resid√™ncia, na falta de casa de albergado, durante o repouso noturno (das 22h √†s 06h), bem como nos dias de folga (tamb√©m das 22h √†s 06h).</div></div>';
            template += '<div class="condition-item"><div class="condition-number">6</div><div><strong>Trabalho:</strong> Comprovar mensalmente √† COSIPE sua atividade laboral, dentro da perspectiva razo√°vel de oferta no mercado de trabalho.</div></div>';
            template += '<div class="condition-item"><div class="condition-number">7</div><div><strong>Comparecimento mensal:</strong> Apresentar-se uma vez por m√™s, a partir de {{MES_ANO_APRESENTACAO}}, no NUALB, situada no Complexo da CISPE (endere√ßo abaixo), via sistema de identifica√ß√£o biom√©trica.</div></div>';
            template += '<div class="condition-item"><div class="condition-number">8</div><div><strong>N√£o viajar:</strong> N√£o se ausentar da comarca sem pr√©via autoriza√ß√£o judicial.</div></div>';
            template += '<div class="condition-item"><div class="condition-number">9</div><div><strong>Acompanhamento psicossocial:</strong> Ser submetido a entrevista e, caso necess√°rio, a acompanhamento pelo N√∫cleo Psicossocial da Secretaria da Administra√ß√£o Penitenci√°ria.</div></div>';
            template += '<div class="condition-item"><div class="condition-number">10</div><div><strong>Programa "Um Novo Tempo":</strong> Participar de pelo menos uma das a√ß√µes do programa, comunicando-se via WhatsApp pelo n√∫mero (85) 3492-9074, com o N√∫cleo de Apoio √†s Varas de Execu√ß√£o Penal, no F√≥rum Cl√≥vis Bevil√°qua.</div></div>';
            template += '</div>';
            
            template += '<div class="contact-info">';
            template += '<h3 style="margin-top: 0; color: #0c5460;">üìç ONDE VOC√ä DEVE SE APRESENTAR MENSALMENTE</h3>';
            template += '<p><strong>Local:</strong> NUALB - Complexo da Coordenadoria de Inclus√£o Social do Preso e do Egresso (CISPE)</p>';
            template += '<p><strong>Endere√ßo:</strong> Avenida Her√°clito Gra√ßa, n.¬∫ 600, bairro Centro, Fortaleza/CE</p>';
            template += '<p><strong>CEP:</strong> 60.140-060</p>';
            template += '<p><strong>Telefone:</strong> (85) 3101-7720</p>';
            template += '<p><strong>Quando come√ßar:</strong> A partir de {{MES_ANO_APRESENTACAO}}</p>';
            template += '<p><strong>Como:</strong> Via sistema de identifica√ß√£o biom√©trica</p>';
            template += '</div>';
            
            template += '<div class="warning-box">';
            template += '<h3 style="margin-top: 0; color: #856404;">‚ö†Ô∏è ATEN√á√ÉO - MUITO IMPORTANTE!</h3>';
            template += '<p><strong>Se voc√™ n√£o cumprir essas regras, pode voltar para a pris√£o.</strong></p>';
            template += '<p>Mantenha sempre seu endere√ßo atualizado e cumpra todos os compromissos.</p>';
            template += '</div>';
            
            template += '<div class="contact-info">';
            template += '<h3 style="margin-top: 0; color: #0c5460;">üìû CONTATOS IMPORTANTES</h3>';
            template += '<p><strong>2¬™ Vara de Execu√ß√£o Penal:</strong></p>';
            template += '<p>üìû Fixo: (85) 3108-1315</p>';
            template += '<p>üì± Celular: (85) 3492-8764 (WhatsApp - N√ÉO recebe liga√ß√µes)</p>';
            template += '<br>';
            template += '<p><strong>Programa "Um Novo Tempo":</strong></p>';
            template += '<p>üì± WhatsApp: (85) 3492-9074</p>';
            template += '<p>üìç Local: N√∫cleo de Apoio √†s Varas de Execu√ß√£o Penal - F√≥rum Cl√≥vis Bevil√°qua</p>';
            template += '<br>';
            template += '<p><strong>NUALB (para apresenta√ß√µes):</strong></p>';
            template += '<p>üìû Telefone: (85) 3101-7720</p>';
            template += '</div>';
            
            template += '{{SECAO_AUDIO}}';
            
            template += '<div style="background: #2c5aa0; color: white; padding: 20px; border-radius: 12px; text-align: center; margin-top: 30px;">';
            template += '<p><strong>Esta decis√£o est√° de acordo com a Recomenda√ß√£o 144/2023 do CNJ sobre Linguagem Simples</strong></p>';
            template += '<p>2¬™ Vara de Execu√ß√£o Penal da Comarca de Fortaleza - Estado do Cear√°</p>';
            template += '<p>üìû D√∫vidas? Entre em contato conosco</p>';
            template += '</div>';
            
            return template;
        }

        // Inicializa√ß√£o quando o DOM carrega
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM carregado, configurando sistema...');
            
            // Definir data atual
            var hoje = new Date().toISOString().split('T')[0];
            document.getElementById('dataDecisao').value = hoje;
            
            // Carregar configura√ß√µes salvas
            carregarConfiguracoes();
            
            // Configurar event listeners
            configurarEventListeners();
            
            // Gerar decis√£o inicial
            gerarDecisao();
            
            console.log('Sistema configurado com sucesso!');
        });

        function configurarEventListeners() {
            try {
                console.log('Configurando event listeners...');
                
                // Bot√µes de navega√ß√£o
                var navTabs = document.querySelectorAll('.nav-tab');
                for (var i = 0; i < navTabs.length; i++) {
                    navTabs[i].addEventListener('click', function() {
                        var tabName = this.getAttribute('data-tab');
                        showTab(tabName);
                    });
                }

                // Bot√µes do formul√°rio
                document.getElementById('btnGerarDecisao').addEventListener('click', gerarDecisao);
                document.getElementById('btnGerarQR').addEventListener('click', gerarQRCode);
                document.getElementById('btnBaixarQR').addEventListener('click', baixarQRCode);
                document.getElementById('btnBaixarPDF').addEventListener('click', baixarPDF);
                document.getElementById('btnBaixarHTML').addEventListener('click', baixarHTML);
                document.getElementById('btnSalvarConfig').addEventListener('click', salvarConfiguracoes);

                // Auto-atualiza√ß√£o da decis√£o quando campos mudam
                var formInputs = document.querySelectorAll('#decisionForm input, #decisionForm textarea, #decisionForm select');
                for (var j = 0; j < formInputs.length; j++) {
                    formInputs[j].addEventListener('input', gerarDecisao);
                    formInputs[j].addEventListener('change', gerarDecisao);
                }

                console.log('Event listeners configurados!');
            } catch (error) {
                console.error('Erro ao configurar event listeners:', error);
                mostrarErro('Erro ao configurar eventos do sistema.');
            }
        }

        function showTab(tabName) {
            try {
                // Remover classe active de todas as abas
                var navTabs = document.querySelectorAll('.nav-tab');
                var tabContents = document.querySelectorAll('.tab-content');
                
                for (var i = 0; i < navTabs.length; i++) {
                    navTabs[i].classList.remove('active');
                }
                for (var j = 0; j < tabContents.length; j++) {
                    tabContents[j].classList.remove('active');
                }
                
                // Adicionar classe active na aba selecionada
                document.querySelector('[data-tab="' + tabName + '"]').classList.add('active');
                document.getElementById(tabName).classList.add('active');
                
                // Atualizar estat√≠sticas se necess√°rio
                if (tabName === 'estatisticas') {
                    atualizarEstatisticas();
                }
                
                console.log('Aba alterada para: ' + tabName);
            } catch (error) {
                console.error('Erro ao trocar aba:', error);
                mostrarErro('Erro ao navegar entre as abas.');
            }
        }

        function gerarDecisao() {
            try {
                console.log('Gerando decis√£o...');
                
                var numeroProcesso = document.getElementById('numeroProcesso').value || '[N√öMERO DO PROCESSO]';
                var nomeApenado = document.getElementById('nomeApenado').value || '[NOME DO APENADO]';
                var dataDecisao = formatarData(document.getElementById('dataDecisao').value) || '[DATA DA DECIS√ÉO]';
                var dataTerminoPena = formatarData(document.getElementById('dataTerminoPena').value) || '[DATA DE T√âRMINO DA PENA]';
                var mesAnoApresentacao = document.getElementById('mesAnoApresentacao').value || '[M√äS/ANO]';
                var linkAudio = document.getElementById('linkAudio').value;

                var secaoAudio = '';
                if (linkAudio) {
                    var qrCodeSection = '';
                    if (qrCodeImg) {
                        qrCodeSection = '<div style="margin: 20px 0;"><img src="' + qrCodeImg.src + '" alt="QR Code COSIPE" style="max-width: 120px; border: 1px solid #ddd; border-radius: 8px;"><p style="font-size: 11px; color: #666; margin-top: 5px;">QR Code para informa√ß√µes da COSIPE</p></div>';
                    }
                    
                    // Gerar QR Code espec√≠fico para o √°udio
                    var qrCodeAudio = 'https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=' + encodeURIComponent(linkAudio);
                    
                    secaoAudio = '<div style="background: white; padding: 25px; border-radius: 12px; text-align: center; margin: 30px 0; box-shadow: 0 2px 10px rgba(0,0,0,0.08); border: 2px dashed #2c5aa0;">';
                    secaoAudio += '<h3 style="color: #2c5aa0;">üéß OU√áA ESTA DECIS√ÉO EM √ÅUDIO</h3>';
                    secaoAudio += '<p>O(A) Juiz(a) gravou um √°udio explicando sua decis√£o de forma simples:</p>';
                    
                    // QR Code do √°udio em destaque
                    secaoAudio += '<div style="display: flex; justify-content: center; align-items: center; gap: 30px; margin: 20px 0; flex-wrap: wrap;">';
                    secaoAudio += '<div style="text-align: center;">';
                    secaoAudio += '<div style="background: #f0f8ff; padding: 15px; border-radius: 10px; border: 2px solid #2c5aa0;">';
                    secaoAudio += '<img src="' + qrCodeAudio + '" alt="QR Code √Åudio" style="max-width: 120px; border-radius: 8px;">';
                    secaoAudio += '</div>';
                    secaoAudio += '<p style="font-weight: bold; color: #2c5aa0; margin: 10px 0 5px 0; font-size: 14px;">üì± ESCANEIE PARA OUVIR</p>';
                    secaoAudio += '<p style="font-size: 12px; color: #666;">Aponte a c√¢mera do celular</p>';
                    secaoAudio += '</div>';
                    
                    // Se houver QR Code da COSIPE, mostrar ao lado
                    if (qrCodeImg) {
                        secaoAudio += '<div style="text-align: center;">';
                        secaoAudio += '<div style="background: #f0f9ff; padding: 15px; border-radius: 10px; border: 2px solid #17a2b8;">';
                        secaoAudio += '<img src="' + qrCodeImg.src + '" alt="QR Code COSIPE" style="max-width: 120px; border-radius: 8px;">';
                        secaoAudio += '</div>';
                        secaoAudio += '<p style="font-weight: bold; color: #17a2b8; margin: 10px 0 5px 0; font-size: 14px;">‚ÑπÔ∏è INFORMA√á√ïES COSIPE</p>';
                        secaoAudio += '<p style="font-size: 12px; color: #666;">Servi√ßos de apoio</p>';
                        secaoAudio += '</div>';
                    }
                    secaoAudio += '</div>';
                    
                    // Link alternativo
                    secaoAudio += '<div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin: 15px 0; border-left: 4px solid #2c5aa0;">';
                    secaoAudio += '<p style="font-weight: bold; color: #2c5aa0; margin-bottom: 10px;">üîó LINK ALTERNATIVO:</p>';
                    secaoAudio += '<p style="font-size: 13px; line-height: 1.6;">Se n√£o conseguir escanear, copie e cole este link no navegador:</p>';
                    secaoAudio += '<p style="background: white; padding: 8px; border: 1px solid #ddd; border-radius: 4px; font-family: monospace; font-size: 11px; word-break: break-all; margin: 8px 0;">' + linkAudio + '</p>';
                    secaoAudio += '</div>';
                    
                    // Player de √°udio (funciona na tela, n√£o no PDF)
                    secaoAudio += '<audio controls style="width: 100%; max-width: 400px; margin: 15px 0;">';
                    secaoAudio += '<source src="' + linkAudio + '" type="audio/mp3">';
                    secaoAudio += 'Seu navegador n√£o suporta reprodu√ß√£o de √°udio.';
                    secaoAudio += '</audio>';
                    
                    secaoAudio += '<p style="font-size: 13px; color: #666;">üí° Se tiver dificuldades, entre em contato pelos telefones indicados nesta decis√£o</p>';
                    secaoAudio += '</div>';
                } else if (qrCodeImg) {
                    secaoAudio = '<div style="background: white; padding: 25px; border-radius: 12px; text-align: center; margin: 30px 0; box-shadow: 0 2px 10px rgba(0,0,0,0.08); border: 2px dashed #2c5aa0;">';
                    secaoAudio += '<h3 style="color: #2c5aa0;">üì± INFORMA√á√ïES COMPLEMENTARES</h3>';
                    secaoAudio += '<p>Escaneie o QR Code abaixo para acessar informa√ß√µes da COSIPE:</p>';
                    secaoAudio += '<div style="margin: 20px 0;">';
                    secaoAudio += '<img src="' + qrCodeImg.src + '" alt="QR Code COSIPE" style="max-width: 150px; border: 1px solid #ddd; border-radius: 8px;">';
                    secaoAudio += '<p style="font-size: 12px; color: #666; margin-top: 5px;">QR Code para informa√ß√µes da Coordenadoria de Inclus√£o Social</p>';
                    secaoAudio += '</div>';
                    secaoAudio += '<p style="font-size: 14px; color: #666;">Aponte a c√¢mera do seu celular para o c√≥digo acima</p>';
                    secaoAudio += '</div>';
                }

                var templateDecisao = criarTemplateDecisao();
                var decisaoFinal = templateDecisao
                    .replace(/{{NUMERO_PROCESSO}}/g, numeroProcesso)
                    .replace(/{{NOME_APENADO}}/g, nomeApenado)
                    .replace(/{{DATA_DECISAO}}/g, dataDecisao)
                    .replace(/{{DATA_TERMINO_PENA}}/g, dataTerminoPena)
                    .replace(/{{MES_ANO_APRESENTACAO}}/g, mesAnoApresentacao)
                    .replace(/{{SECAO_AUDIO}}/g, secaoAudio);

                document.getElementById('previewDecisao').innerHTML = decisaoFinal;
                
                // Mostrar mensagem de sucesso se campos obrigat√≥rios preenchidos
                if (numeroProcesso !== '[N√öMERO DO PROCESSO]' && nomeApenado !== '[NOME DO APENADO]') {
                    mostrarSucesso();
                    incrementarContador('totalDecisoes');
                }
                
                document.querySelector('.preview-section').scrollTop = 0;
                
                console.log('Decis√£o gerada com sucesso!');
            } catch (error) {
                console.error('Erro ao gerar decis√£o:', error);
                mostrarErro('Erro ao gerar a decis√£o. Verifique os dados inseridos.');
            }
        }

        function gerarQRCode() {
            try {
                console.log('Gerando QR Code...');
                
                var linkCOSIPE = 'https://www.ceara.gov.br/2014/10/29/coordenadoria-de-inclusao-social-da-sejus-esta-em-novo-endereco/';
                var qrUrl = 'https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=' + encodeURIComponent(linkCOSIPE);
                
                var qrContainer = document.getElementById('qrCodeContainer');
                qrContainer.innerHTML = '<img src="' + qrUrl + '" alt="QR Code" style="max-width: 150px; border: 1px solid #ddd; border-radius: 8px;">' +
                    '<p style="margin-top: 10px; font-size: 12px; color: #666;">QR Code para informa√ß√µes da COSIPE</p>';
                
                qrCodeImg = qrContainer.querySelector('img');
                document.getElementById('qrDisplay').style.display = 'block';
                
                incrementarContador('totalQRCodes');
                gerarDecisao();
                
                console.log('QR Code gerado com sucesso!');
            } catch (error) {
                console.error('Erro ao gerar QR Code:', error);
                mostrarErro('Erro ao gerar QR Code. Verifique sua conex√£o com a internet.');
            }
        }

        function baixarQRCode() {
            try {
                if (qrCodeImg) {
                    var link = document.createElement('a');
                    link.href = qrCodeImg.src;
                    link.download = 'qrcode-cosipe-decisao.png';
                    link.click();
                    console.log('QR Code baixado!');
                } else {
                    mostrarErro('Nenhum QR Code foi gerado ainda.');
                }
            } catch (error) {
                console.error('Erro ao baixar QR Code:', error);
                mostrarErro('Erro ao baixar QR Code.');
            }
        }

        function formatarData(dataString) {
            if (!dataString) return '';
            try {
                var data = new Date(dataString + 'T00:00:00');
                return data.toLocaleDateString('pt-BR');
            } catch (error) {
                console.error('Erro ao formatar data:', error);
                return dataString;
            }
        }

        function baixarPDF() {
            try {
                var conteudo = document.getElementById('previewDecisao');
                if (conteudo && !conteudo.innerHTML.includes('[N√öMERO DO PROCESSO]')) {
                    alert('Para baixar como PDF:\n\n1. Use Ctrl+P (Windows) ou Cmd+P (Mac)\n2. Selecione "Salvar como PDF"\n3. Escolha o local para salvar\n\nOu clique com bot√£o direito na pr√©-visualiza√ß√£o e selecione "Imprimir"');
                } else {
                    mostrarErro('Gere uma decis√£o completa antes de baixar o PDF.');
                }
            } catch (error) {
                console.error('Erro ao baixar PDF:', error);
                mostrarErro('Erro ao gerar PDF. Use Ctrl+P para imprimir.');
            }
        }

        function baixarHTML() {
            try {
                var conteudo = document.getElementById('previewDecisao').innerHTML;
                var nomeApenado = document.getElementById('nomeApenado').value || 'Decisao';
                var nomeArquivo = 'decisao-' + nomeApenado.replace(/\s+/g, '-').toLowerCase() + '.html';

                var htmlCompleto = '<!DOCTYPE html>';
                htmlCompleto += '<html lang="pt-BR">';
                htmlCompleto += '<head>';
                htmlCompleto += '<meta charset="UTF-8">';
                htmlCompleto += '<meta name="viewport" content="width=device-width, initial-scale=1.0">';
                htmlCompleto += '<title>Decis√£o em Linguagem Simples</title>';
                htmlCompleto += '<style>';
                htmlCompleto += 'body { font-family: Arial, sans-serif; line-height: 1.6; background-color: #f8f9fa; padding: 20px; max-width: 800px; margin: 0 auto; }';
                htmlCompleto += '.header { background: linear-gradient(135deg, #2c5aa0 0%, #1e3d72 100%); color: white; padding: 30px; border-radius: 15px; text-align: center; margin-bottom: 30px; }';
                htmlCompleto += '.info-box { background: white; padding: 25px; border-radius: 12px; margin-bottom: 20px; border-left: 5px solid #28a745; }';
                htmlCompleto += '.success-box { background: #d4edda; border: 1px solid #c3e6cb; padding: 20px; border-radius: 8px; margin: 20px 0; border-left: 5px solid #28a745; }';
                htmlCompleto += '.warning-box { background: #fff3cd; border: 1px solid #ffeaa7; padding: 20px; border-radius: 8px; margin: 20px 0; border-left: 5px solid #f39c12; }';
                htmlCompleto += '.condition-item { display: flex; align-items: flex-start; margin: 15px 0; padding: 15px; background: #f8f9fa; border-radius: 8px; border-left: 4px solid #2c5aa0; }';
                htmlCompleto += '.condition-number { background: #2c5aa0; color: white; border-radius: 50%; width: 25px; height: 25px; display: flex; align-items: center; justify-content: center; font-weight: bold; margin-right: 15px; font-size: 0.9em; flex-shrink: 0; }';
                htmlCompleto += '.contact-info { background: white; padding: 20px; border-radius: 8px; margin: 20px 0; border-left: 5px solid #17a2b8; }';
                htmlCompleto += '.highlight { background: #fff3cd; padding: 3px 8px; border-radius: 4px; font-weight: bold; }';
                htmlCompleto += 'strong { color: #2c5aa0; }';
                htmlCompleto += '</style>';
                htmlCompleto += '</head>';
                htmlCompleto += '<body>';
                htmlCompleto += conteudo;
                htmlCompleto += '</body>';
                htmlCompleto += '</html>';

                var blob = new Blob([htmlCompleto], { type: 'text/html' });
                var url = URL.createObjectURL(blob);
                var a = document.createElement('a');
                a.href = url;
                a.download = nomeArquivo;
                a.click();
                URL.revokeObjectURL(url);
                
                console.log('HTML baixado: ' + nomeArquivo);
            } catch (error) {
                console.error('Erro ao baixar HTML:', error);
                mostrarErro('Erro ao gerar arquivo HTML.');
            }
        }

        function incrementarContador(tipo) {
            try {
                if (contadores[tipo] !== undefined) {
                    contadores[tipo]++;
                    var elemento = document.getElementById(tipo);
                    if (elemento) {
                        elemento.textContent = contadores[tipo];
                    }
                }
            } catch (error) {
                console.error('Erro ao incrementar contador:', error);
            }
        }

        function atualizarEstatisticas() {
            try {
                document.getElementById('totalDecisoes').textContent = contadores.totalDecisoes;
                document.getElementById('totalAudios').textContent = contadores.totalAudios;
                document.getElementById('totalQRCodes').textContent = contadores.totalQRCodes;
            } catch (error) {
                console.error('Erro ao atualizar estat√≠sticas:', error);
            }
        }

        function salvarConfiguracoes() {
            try {
                configuracoes.nomeJuiz = document.getElementById('nomeJuiz').value;
                configuracoes.comarca = document.getElementById('comarca').value;
                configuracoes.telefoneContato = document.getElementById('telefoneContato').value;
                
                mostrarSucesso('Configura√ß√µes salvas com sucesso!');
                console.log('Configura√ß√µes salvas na sess√£o!');
            } catch (error) {
                console.error('Erro ao salvar configura√ß√µes:', error);
                mostrarErro('Erro ao salvar configura√ß√µes.');
            }
        }

        function carregarConfiguracoes() {
            try {
                document.getElementById('nomeJuiz').value = configuracoes.nomeJuiz;
                document.getElementById('comarca').value = configuracoes.comarca;
                document.getElementById('telefoneContato').value = configuracoes.telefoneContato;
                console.log('Configura√ß√µes carregadas com sucesso!');
            } catch (error) {
                console.error('Erro ao carregar configura√ß√µes:', error);
            }
        }

        function mostrarSucesso(mensagem) {
            mensagem = mensagem || '‚úÖ Decis√£o gerada com sucesso! Use os bot√µes abaixo para baixar.';
            var successEl = document.getElementById('successMessage');
            var errorEl = document.getElementById('errorMessage');
            
            if (successEl) {
                successEl.textContent = mensagem;
                successEl.style.display = 'block';
            }
            if (errorEl) {
                errorEl.style.display = 'none';
            }
        }

        function mostrarErro(mensagem) {
            var errorEl = document.getElementById('errorMessage');
            var successEl = document.getElementById('successMessage');
            
            if (errorEl) {
                errorEl.textContent = '‚ùå ' + mensagem;
                errorEl.style.display = 'block';
            }
            if (successEl) {
                successEl.style.display = 'none';
            }
            
            console.error(mensagem);
        }

        console.log('Script JavaScript carregado completamente!');
    </script>
</body>
</html>